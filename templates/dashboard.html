{% extends 'base.html' %}
{% block title %}Översikt{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}
{% block content %}
<section class="dashboard">
    <h1>
        {% if user_name %}
            Hej {{ user_name }}! Här är dina intyg.
        {% else %}
            Hej! Här är dina intyg.
        {% endif %}
    </h1>
    <div class="support-actions" aria-label="Sektion för att kontakta supporten">
        <p class="support-text">Behöver du radera dina uppgifter? Kontakta oss så hjälper vi dig.</p>
        <a class="support-email-button" href="mailto:support@utbildningsintyg.se?subject=Beg%C3%A4ran%20om%20radering%20av%20anv%C3%A4ndardata&body=Hej%20supportteamet%2C%0A%0AJag%20vill%20beg%C3%A4ra%20att%20all%20min%20anv%C3%A4ndardata%20tas%20bort.%0A%0AV%C3%A4nligen%20bekr%C3%A4fta%20n%C3%A4r%20det%20%C3%A4r%20klart.%0A%0ATack!">Begär radering av mina uppgifter</a>
    </div>
    {% if category_summary %}
    <section class="category-list" aria-label="Tillgängliga kurskategorier">
        <h2>Kurskategorier</h2>
        <ul>
            {% for category in category_summary %}
            <li>
                <span class="category-label">{{ category.label }}</span>
                <span class="category-count-badge">{{ category.count }} intyg</span>
            </li>
            {% endfor %}
        </ul>
    </section>
    {% endif %}

    {% if grouped_pdfs %}
    <section class="category-groups" aria-label="Intyg sorterade efter kategori">
        {% for group in grouped_pdfs %}
        <article class="category-group">
            <header class="category-header">
                <h3>{{ group.label }}</h3>
                <p class="category-count">{{ group.pdfs | length }} intyg</p>
            </header>
            <ul class="pdf-list">
                {% for pdf in group.pdfs %}
                <li data-pdf-categories="{{ pdf.categories | join(',') }}">
                    <a href="{{ url_for('download_pdf', pdf_id=pdf.id) }}" download>
                        {{ pdf.filename }}
                    </a>
                    <span class="pdf-meta">
                        <strong>Kategorier:</strong>
                        {% if pdf.category_labels %}
                            {{ pdf.category_labels | join(', ') }}
                        {% else %}
                            Inte angiven
                        {% endif %}
                        <br>
                        
                    </span>
                </li>
                {% endfor %}
            </ul>
        </article>
        {% endfor %}
    </section>
    {% else %}
    <p>Inga PDF:er uppladdade.</p>
    {% endif %}
</section>
{% endblock %}
