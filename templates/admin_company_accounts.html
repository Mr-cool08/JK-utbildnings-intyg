<!-- # Copyright (c) Liam Suorsa -->
{% extends 'base.html' %}
{% block title %}Admin — Företagskonton{% endblock %}
{% block content %}
<h1>Admin — Företagskonton</h1>
<p>Här skapar du företagskonton, kopplar dem till användare och hanterar kopplingar.</p>
<span class="sr-only" data-csrf-token="{{ csrf_token }}"></span>

<nav class="admin-nav" aria-label="Administrationsnavigering">
    <a class="btn" href="{{ url_for('admin') }}">Start</a>
    <a class="btn" href="{{ url_for('admin_accounts') }}">Konton &amp; återställning</a>
    <a class="btn" href="{{ url_for('admin_certificates') }}">Intyg &amp; verifiering</a>
    <a class="btn" href="{{ url_for('admin_company_accounts') }}">Företagskonton</a>
    <a class="btn" href="{{ url_for('admin_applications') }}">Ansökningar</a>
    <a class="btn" href="{{ url_for('admin_invoicing') }}">Fakturering</a>
    <a class="btn" href="{{ url_for('admin_advanced') }}">Avancerade verktyg</a>
    <a class="btn" href="{{ url_for('admin_guide') }}">Guide</a>
</nav>

<section class="panel">
    <h2>Skapa företagskonto</h2>
    <p>Registrera ett nytt företagskonto som kan kopplas till användarkonton.</p>
    <form id="createSupervisorForm" class="stacked-form" method="post">
        <label for="supervisorName">Namn</label>
        <input id="supervisorName" name="name" type="text" required placeholder="Namn på företagskonto">

        <label for="supervisorEmail">E-post</label>
        <input id="supervisorEmail" name="email" type="email" required placeholder="foretagskonto@example.com">

        <button type="submit" class="btn">Skapa företagskonto</button>
        <p id="createSupervisorMessage" class="message" aria-live="polite" style="display:none"></p>
    </form>
</section>

<section class="panel">
    <h2>Koppla företagskonto</h2>
    <p>Skapa koppling mellan ett företagskonto och ett befintligt användarkonto.</p>
    <form id="linkSupervisorForm" class="stacked-form" method="post">
        <label for="linkSupervisorOrgnr">Organisationsnummer</label>
        <input id="linkSupervisorOrgnr" name="orgnr" type="text" required placeholder="Exempel: 556966-8337">

        <label for="linkPersonnummer">Användarkontots personnummer</label>
        <input id="linkPersonnummer" name="personnummer" type="text" required placeholder="ÅÅMMDDXXXX" data-personnummer-target="true">

        <button type="submit" class="btn">Skapa koppling</button>
        <p id="linkSupervisorMessage" class="message" aria-live="polite" style="display:none"></p>
    </form>
</section>

<section class="panel">
    <h2>Ta bort koppling</h2>
    <p>Ta bort kopplingen mellan ett företagskonto och ett standardkonto.</p>
    <form id="removeSupervisorForm" class="stacked-form" method="post">
        <label for="removeSupervisorOrgnr">Organisationsnummer</label>
        <input id="removeSupervisorOrgnr" name="orgnr" type="text" required placeholder="Exempel: 556966-8337">

        <label for="removePersonnummer">Användarkontots personnummer</label>
        <input id="removePersonnummer" name="personnummer" type="text" required placeholder="ÅÅMMDDXXXX" data-personnummer-target="true">

        <button type="submit" class="btn btn-danger">Ta bort koppling</button>
        <p id="removeSupervisorMessage" class="message" aria-live="polite" style="display:none"></p>
    </form>
</section>

<section class="panel">
    <h2>Ändra koppling</h2>
    <p>Flytta ett standardkonto från ett företagskonto till ett annat.</p>
    <form id="changeSupervisorForm" class="stacked-form" method="post">
        <label for="changeSupervisorFromOrgnr">Nuvarande organisationsnummer</label>
        <input id="changeSupervisorFromOrgnr" name="from_orgnr" type="text" required placeholder="Exempel: 556966-8337">

        <label for="changeSupervisorToOrgnr">Nytt organisationsnummer</label>
        <input id="changeSupervisorToOrgnr" name="to_orgnr" type="text" required placeholder="Exempel: 556966-8337">

        <label for="changePersonnummer">Användarkontots personnummer</label>
        <input id="changePersonnummer" name="personnummer" type="text" required placeholder="ÅÅMMDDXXXX" data-personnummer-target="true">

        <button type="submit" class="btn">Uppdatera koppling</button>
        <p id="changeSupervisorMessage" class="message" aria-live="polite" style="display:none"></p>
    </form>
</section>

<section class="panel">
    <h2>Visa kopplingar</h2>
    <p>Se vilka användarkonton som är kopplade till ett företagskonto och ta bort kopplingar från listan.</p>
    <form id="supervisorOverviewForm" class="inline-form" method="post">
        <label for="overviewSupervisorOrgnr">Organisationsnummer</label>
        <input id="overviewSupervisorOrgnr" name="orgnr" type="text" required placeholder="Exempel: 556966-8337">
        <button type="submit" class="btn">Visa kopplingar</button>
        <span id="supervisorOverviewMessage" class="message" aria-live="polite" style="display:none"></span>
    </form>

    <div id="supervisorOverviewCard" class="card" hidden>
        <h3 id="supervisorOverviewTitle">Kopplade användarkonton</h3>
        <div class="table-scroll">
            <table>
                <thead>
                    <tr>
                        <th>Användarnamn</th>
                        <th>Information</th>
                        <th>Åtgärd</th>
                    </tr>
                </thead>
                <tbody id="supervisorOverviewBody"></tbody>
            </table>
        </div>
    </div>
</section>

<section class="panel">
    <h2>Radera företagskonto</h2>
    <p>Ta bort företagskontot och alla kopplingar till standardkonton.</p>
    <form id="deleteSupervisorForm" class="stacked-form" method="post">
        <label for="deleteSupervisorOrgnr">Organisationsnummer</label>
        <input id="deleteSupervisorOrgnr" name="orgnr" type="text" required placeholder="Exempel: 556966-8337">

        <button type="submit" class="btn btn-danger">Radera företagskonto</button>
        <p id="deleteSupervisorMessage" class="message" aria-live="polite" style="display:none"></p>
    </form>
</section>

<script src="{{ url_for('static', filename='js/admin_api_client.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin_panel_storage.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin_panel_personnummer.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin_panel_company.js') }}"></script>
{% endblock %}
<!-- # Copyright (c) Liam Suorsa -->
