# /etc/borgmatic/config.yaml
# Modern borgmatic-konfig (global scope, inga deprecated sektioner)
# Kräver att du har BORG_REPO och BORG_PASSPHRASE i din .env

source_directories:
  - /source/etc
  - /source/home
  - /source/var
  - /source/root

# Repository tas från env-var. Exempel i .env:
# BORG_REPO=ssh://USER@USER.repo.borgbase.com/./repo/REPO_ID
repositories:
  - path: "{BORG_REPO}"
    label: borgbase

exclude_patterns:
  - "*.tmp"
  - "*.cache"
  - /source/home/*/.cache
  - /source/root/.cache

# Om du vill slippa backa upp vissa mappar genom en fil:
# exclude_if_present: .nobackup

one_file_system: true

compression: lz4

# BorgBase kör ofta "borg1" som remote_path (lämna om du redan vet att det funkar hos dig)
remote_path: borg1

# Passphrase från env-var (rekommenderat)
encryption_passphrase: "{BORG_PASSPHRASE}"

# Samma arkivnamnsformat som du använde tidigare (enkelt & kompatibelt)
archive_name_format: "{hostname}-{now}"

# Retention
keep_daily: 7
keep_weekly: 4
keep_monthly: 6
keep_yearly: 1

# Konsistenskontroller (nya formatet: list av key/value)
checks:
  - name: repository
  - name: archives

check_last: 3

# Bra att ha om du vill köra extra “säkert”:
# check_repositories:
#   - borgbase
